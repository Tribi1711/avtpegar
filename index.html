<!DOCTYPE html>
<html>
<head>
    <title>¡Pega a Aitor! - Cookie Clicker Style</title>
<!-- Añade esto en el <head> de tu HTML -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#FF6B00">
    <style>
        :root {
            --color-primary: #FF6B00;
            --color-secondary: #FFA500;
            --color-dark: #121212;
            --color-darker: #0A0A0A;
            --color-light: #E0E0E0;
            --color-accent: #FF4500;
        }
        
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--color-dark);
            color: var(--color-light);
            overflow-x: hidden;
            touch-action: manipulation;
        }
        
        #header {
            background: linear-gradient(90deg, var(--color-primary), var(--color-accent));
            padding: 15px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            position: relative;
            z-index: 10;
        }
        
        #title {
            font-size: 2.5rem;
            margin: 0;
            font-weight: 800;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            color: white;
        }
        
        #gameContainer {
            display: flex;
            min-height: calc(100vh - 60px);
        }
        
        #leftPanel {
            width: 70%;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background-color: var(--color-darker);
        }
        
        #aitorContainer {
            position: relative;
            margin-bottom: 30px;
        }
        
        #aitor {
            width: 250px;
            height: 250px;
            cursor: pointer;
            border-radius: 50%;
            object-fit: cover;
            box-shadow: 0 10px 25px rgba(0,0,0,0.6);
            transition: transform 0.1s;
            border: 5px solid var(--color-primary);
            background-color: #222;
        }
        
        #scoreContainer {
            background: rgba(0,0,0,0.7);
            padding: 15px 30px;
            border-radius: 50px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            border: 1px solid var(--color-primary);
        }
        
        #score {
            font-size: 2rem;
            font-weight: bold;
            color: var(--color-secondary);
            margin: 0;
            text-align: center;
        }
        
        #scorePerSecond {
            font-size: 1rem;
            color: var(--color-light);
            margin: 5px 0 0;
            text-align: center;
            opacity: 0.8;
        }
        
        #rightPanel {
            width: 30%;
            background: var(--color-darker);
            padding: 20px;
            overflow-y: auto;
            border-left: 2px solid var(--color-primary);
        }
        
        .panelTitle {
            font-size: 1.5rem;
            margin-top: 0;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--color-primary);
            color: var(--color-secondary);
        }
        
        .upgrade, .achievement {
            background: rgba(30,30,30,0.8);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            border: 1px solid #333;
        }
        
        .upgrade:hover {
            background: rgba(50,50,50,0.8);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255,107,0,0.3);
        }
        
        .upgrade-icon {
            font-size: 2rem;
            margin-right: 15px;
            width: 50px;
            text-align: center;
            color: var(--color-secondary);
        }
        
        .upgrade-info {
            flex: 1;
        }
        
        .upgrade-name {
            font-weight: bold;
            margin: 0 0 5px;
            color: var(--color-light);
        }
        
        .upgrade-description {
            font-size: 0.8rem;
            margin: 0;
            color: #AAA;
        }
        
        .upgrade-price {
            font-weight: bold;
            color: var(--color-secondary);
            font-size: 1.1rem;
        }
        
        .locked {
            filter: grayscale(80%);
            opacity: 0.7;
            cursor: not-allowed;
            background: rgba(20,20,20,0.8) !important;
        }
        
        .unlocked {
            background: linear-gradient(90deg, rgba(255,107,0,0.3), transparent);
            border-left: 4px solid var(--color-primary);
        }
        
        #damageEffect {
            position: absolute;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--color-secondary);
            pointer-events: none;
            animation: floatUp 1s forwards;
            text-shadow: 0 0 5px black;
            z-index: 5;
        }
        
        @keyframes floatUp {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) scale(0.5);
                opacity: 0;
            }
        }
        
        #clickEffect {
            position: absolute;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, rgba(255,107,0,0.5), transparent 70%);
            border-radius: 50%;
            pointer-events: none;
            transform: translate(-50%, -50%);
            animation: clickPulse 0.5s forwards;
            z-index: 2;
        }
        
        @keyframes clickPulse {
            0% {
                transform: translate(-50%, -50%) scale(0.5);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(1.5);
                opacity: 0;
            }
        }
        
        #hitMessages {
            position: absolute;
            bottom: 120px;
            width: 100%;
            text-align: center;
            font-size: 1.2rem;
            color: var(--color-secondary);
            text-shadow: 0 0 5px black;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        #achievementsContainer {
            margin-top: 30px;
        }
        
        .achievement {
            cursor: default;
        }
        
        .achievement.unlocked {
            background: linear-gradient(90deg, rgba(255,107,0,0.3), transparent);
        }
        
        .achievement-icon {
            font-size: 1.5rem;
            margin-right: 15px;
            color: var(--color-secondary);
        }
        
        .tab {
            display: none;
        }
        
        .tab.active {
            display: block;
        }
        
        #tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--color-primary);
        }
        
        .tab-button {
            background: none;
            border: none;
            color: var(--color-light);
            padding: 10px 20px;
            cursor: pointer;
            font-size: 1rem;
            position: relative;
            transition: all 0.3s;
        }
        
        .tab-button:hover {
            color: var(--color-secondary);
        }
        
        .tab-button.active {
            color: var(--color-primary);
            font-weight: bold;
        }
        
        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--color-primary);
        }
        
        #specialAttacks {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .specialAttack {
            background: rgba(255,107,0,0.2);
            border: 2px solid var(--color-primary);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            width: calc(50% - 20px);
        }
        
        .specialAttack:hover {
            background: rgba(255,107,0,0.4);
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255,107,0,0.3);
        }
        
        .specialAttack:active {
            transform: scale(0.95);
        }
        
        .specialAttack-icon {
            font-size: 2rem;
            margin-bottom: 5px;
            color: var(--color-secondary);
        }
        
        .specialAttack-cooldown {
            height: 4px;
            background: rgba(255,255,255,0.1);
            margin-top: 5px;
            border-radius: 2px;
            overflow: hidden;
        }
        
        .specialAttack-cooldown-bar {
            height: 100%;
            background: var(--color-primary);
            width: 0%;
            transition: width 0.1s linear;
        }
        
        #aitorHealth {
            width: 100%;
            height: 10px;
            background: rgba(255,0,0,0.2);
            border-radius: 5px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        #aitorHealthBar {
            height: 100%;
            width: 100%;
            background: linear-gradient(90deg, var(--color-accent), var(--color-primary));
            transition: width 0.3s;
        }
        
        #aitorLevel {
            text-align: center;
            margin-top: 5px;
            font-size: 0.9rem;
            color: var(--color-secondary);
        }
        
        #criticalHit {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 5rem;
            font-weight: bold;
            color: var(--color-secondary);
            text-shadow: 0 0 20px var(--color-primary);
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            animation: criticalAnimation 1s;
        }
        
        @keyframes criticalAnimation {
            0% {
                transform: translate(-50%, -50%) scale(0.5);
                opacity: 1;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(2);
                opacity: 0;
            }
        }
        
        /* Notificaciones */
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        @keyframes slideOut {
            from { transform: translateX(0); }
            to { transform: translateX(100%); }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            #gameContainer {
                flex-direction: column;
            }
            
            #leftPanel, #rightPanel {
                width: 100%;
            }
            
            #rightPanel {
                height: auto;
                max-height: 400px;
            }
            
            #aitor {
                width: 200px;
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <div id="header">
        <h1 id="title">¡Pega a Aitor!</h1>
    </div>
    
    <div id="gameContainer">
        <div id="leftPanel">
            <div id="aitorContainer">
                <img id="aitor" src="images.jpeg" alt="Aitor">
                <div id="hitMessages"></div>
            </div>
            
            <div id="scoreContainer">
                <h2 id="score">0 golpes</h2>
                <p id="scorePerSecond">0 golpes/segundo</p>
            </div>
            
            <div id="aitorHealth">
                <div id="aitorHealthBar"></div>
            </div>
            <p id="aitorLevel">Nivel 1 - Aitor Novato</p>
            
            <div id="specialAttacks">
                <div class="specialAttack" data-damage="50" data-cooldown="10" id="special1">
                    <div class="specialAttack-icon">💥</div>
                    <div>Golpe Crítico</div>
                    <div class="specialAttack-cooldown">
                        <div class="specialAttack-cooldown-bar"></div>
                    </div>
                </div>
                
                <div class="specialAttack" data-damage="100" data-cooldown="30" id="special2">
                    <div class="specialAttack-icon">🔥</div>
                    <div>Ataque Fuego</div>
                    <div class="specialAttack-cooldown">
                        <div class="specialAttack-cooldown-bar"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="rightPanel">
            <div id="tabs">
                <button class="tab-button active" data-tab="upgrades">Mejoras</button>
                <button class="tab-button" data-tab="achievements">Logros</button>
                <button class="tab-button" data-tab="stats">Estadísticas</button>
            </div>
            
            <div id="upgrades" class="tab active">
                <h3 class="panelTitle">Mejoras</h3>
                
                <div class="upgrade" data-id="2" data-price="3000" data-multiplier="0.5" data-unlocked="true">
                    <div class="upgrade-icon">👨‍🍳</div>
                    <div class="upgrade-info">
                        <p class="upgrade-name">Chef Aitor</p>
                        <p class="upgrade-description">Aitor cocina para ti (+0.5 golpes/seg)</p>
                    </div>
                    <div class="upgrade-price">3,000</div>
                </div>
                
                <div class="upgrade locked" data-id="3" data-price="6000" data-multiplier="1" data-unlocked="false">
                    <div class="upgrade-icon">👯</div>
                    <div class="upgrade-info">
                        <p class="upgrade-name">Clon de Aitor</p>
                        <p class="upgrade-description">Un clon ayuda a golpear (+1 golpe/seg)</p>
                    </div>
                    <div class="upgrade-price">6,000</div>
                </div>
                
                <div class="upgrade locked" data-id="4" data-price="12000" data-multiplier="2" data-unlocked="false">
                    <div class="upgrade-icon">🏭</div>
                    <div class="upgrade-info">
                        <p class="upgrade-name">Fábrica de Aitors</p>
                        <p class="upgrade-description">Producción en masa (+2 golpes/seg)</p>
                    </div>
                    <div class="upgrade-price">12,000</div>
                </div>
                
                <div class="upgrade locked" data-id="5" data-price="24000" data-multiplier="5" data-unlocked="false">
                    <div class="upgrade-icon">🌎</div>
                    <div class="upgrade-info">
                        <p class="upgrade-name">Aitor Global</p>
                        <p class="upgrade-description">Aitors en todo el mundo (+5 golpes/seg)</p>
                    </div>
                    <div class="upgrade-price">24,000</div>
                </div>
                
                <div class="upgrade locked" data-id="6" data-price="35000" data-multiplier="10" data-unlocked="false">
                    <div class="upgrade-icon">🚀</div>
                    <div class="upgrade-info">
                        <p class="upgrade-name">Aitor Espacial</p>
                        <p class="upgrade-description">Aitors en el espacio (+10 golpes/seg)</p>
                    </div>
                    <div class="upgrade-price">35,000</div>
                </div>
            </div>
            
            <div id="achievements" class="tab">
                <h3 class="panelTitle">Logros</h3>
                
                <div class="achievement locked" data-id="1" data-required="10">
                    <div class="achievement-icon">🔓</div>
                    <div class="upgrade-info">
                        <p class="upgrade-name">Novato Golpeador</p>
                        <p class="upgrade-description">Da 10 golpes a Aitor</p>
                    </div>
                </div>
                
                <div class="achievement locked" data-id="2" data-required="100">
                    <div class="achievement-icon">🔓</div>
                    <div class="upgrade-info">
                        <p class="upgrade-name">Aprendiz del Dolor</p>
                        <p class="upgrade-description">Da 100 golpes a Aitor</p>
                    </div>
                </div>
                
                <div class="achievement locked" data-id="3" data-required="1000">
                    <div class="achievement-icon">🔓</div>
                    <div class="upgrade-info">
                        <p class="upgrade-name">Maestro Torturador</p>
                        <p class="upgrade-description">Da 1,000 golpes a Aitor</p>
                    </div>
                </div>
                
                <div class="achievement locked" data-id="4" data-required="1000000">
                    <div class="achievement-icon">🔓</div>
                    <div class="upgrade-info">
                        <p class="upgrade-name">Leyenda de Aitor</p>
                        <p class="upgrade-description">Da 1000000 golpes a Aitor</p>
                    </div>
                </div>
                
                <div class="achievement locked" data-id="5" data-required="1">
                    <div class="achievement-icon">🔓</div>
                    <div class="upgrade-info">
                        <p class="upgrade-name">Primera Compra</p>
                        <p class="upgrade-description">Compra tu primera mejora</p>
                    </div>
                </div>
                
                <div class="achievement locked" data-id="6" data-required="100">
                    <div class="achievement-icon">🔓</div>
                    <div class="upgrade-info">
                        <p class="upgrade-name">Crítico</p>
                        <p class="upgrade-description">Realiza un golpe crítico</p>
                    </div>
                </div>
            </div>
            
            <div id="stats" class="tab">
                <h3 class="panelTitle">Estadísticas</h3>
                
                <div class="achievement">
                    <div class="upgrade-info">
                        <p class="upgrade-name">Golpes Totales</p>
                        <p class="upgrade-description" id="totalHits">0</p>
                    </div>
                </div>
                
                <div class="achievement">
                    <div class="upgrade-info">
                        <p class="upgrade-name">Golpes por Click</p>
                        <p class="upgrade-description" id="clickPower">1</p>
                    </div>
                </div>
                
                <div class="achievement">
                    <div class="upgrade-info">
                        <p class="upgrade-name">Golpes por Segundo</p>
                        <p class="upgrade-description" id="hitsPerSecond">0</p>
                    </div>
                </div>
                
                <div class="achievement">
                    <div class="upgrade-info">
                        <p class="upgrade-name">Mejoras Compradas</p>
                        <p class="upgrade-description" id="upgradesBought">0</p>
                    </div>
                </div>
                
                <div class="achievement">
                    <div class="upgrade-info">
                        <p class="upgrade-name">Logros Desbloqueados</p>
                        <p class="upgrade-description" id="achievementsUnlocked">0</p>
                    </div>
                </div>
                
                <div class="achievement">
                    <div class="upgrade-info">
                        <p class="upgrade-name">Nivel de Aitor</p>
                        <p class="upgrade-description" id="aitorLevelStat">1</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="criticalHit">¡CRÍTICO!</div>
    
    <script>
        // Variables del juego
        let score = 0;
        let totalHits = 0;
        let clickPower = 1;
        let passiveIncome = 0;
        let upgradesBought = 0;
        let achievementsUnlocked = 0;
        let aitorLevel = 1;
        let aitorHealth = 100;
        let maxAitorHealth = 100;
        let criticalChance = 0.05; // 5% de chance de golpe crítico
        let criticalMultiplier = 2;
        
        // Mensajes aleatorios al golpear
        const hitMessages = [
            "¡Será posible!",
            "¡Me cago en la hostia santa!",
            "Hostias",
        ];
        
        // Mejoras compradas
        const upgrades = {
            2: true // Chef Aitor empezará desbloqueado
        };
        
        // Logros
        const achievements = {
            1: false, // 10 golpes
            2: false, // 100 golpes
            3: false, // 1,000 golpes
            4: false, // 10,000 golpes
            5: false, // Primera compra
            6: false  // Primer crítico
        };
        
        // Cooldowns de ataques especiales
        const specialAttacksCooldown = {
            special1: 0,
            special2: 0
        };
        
        // Elementos del DOM
        const scoreElement = document.getElementById('score');
        const scorePerSecondElement = document.getElementById('scorePerSecond');
        const aitorElement = document.getElementById('aitor');
        const aitorHealthBar = document.getElementById('aitorHealthBar');
        const aitorLevelElement = document.getElementById('aitorLevel');
        const criticalHitElement = document.getElementById('criticalHit');
        const hitMessagesElement = document.getElementById('hitMessages');
        
        // Inicializar el juego
        function initGame() {
            loadGame();
            setupEventListeners();
            updateUI();
            
            // Bucle principal del juego
            setInterval(gameLoop, 1000);
            setInterval(updateCooldowns, 100);
        }
        
        // Bucle del juego
        function gameLoop() {
            // Generar ingresos pasivos
            addScore(passiveIncome);
            totalHits += passiveIncome;
            
            // Actualizar UI
            updateUI();
            saveGame();
        }
        
        // Actualizar cooldowns
        function updateCooldowns() {
            Object.keys(specialAttacksCooldown).forEach(key => {
                if (specialAttacksCooldown[key] > 0) {
                    specialAttacksCooldown[key] -= 0.1;
                    if (specialAttacksCooldown[key] < 0) specialAttacksCooldown[key] = 0;
                    
                    const cooldownElement = document.querySelector(`#${key} .specialAttack-cooldown-bar`);
                    if (cooldownElement) {
                        const cooldownTime = parseInt(document.getElementById(key).getAttribute('data-cooldown'));
                        const percentage = (specialAttacksCooldown[key] / cooldownTime) * 100;
                        cooldownElement.style.width = `${100 - percentage}%`;
                    }
                }
            });
        }
        
        // Configurar event listeners
        function setupEventListeners() {
            // Click en Aitor
            aitorElement.addEventListener('click', function(e) {
                hitAitor(e);
            });
            
            // Ataques especiales
            document.querySelectorAll('.specialAttack').forEach(attack => {
                attack.addEventListener('click', function(e) {
                    useSpecialAttack(e);
                });
            });
            
            // Mejoras
            document.querySelectorAll('.upgrade').forEach(upgrade => {
                upgrade.addEventListener('click', function(e) {
                    buyUpgrade(e);
                });
            });
            
            // Tabs
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', function(e) {
                    switchTab(e);
                });
            });
        }
        
        // Golpear a Aitor
        function hitAitor(e) {
            let damage = clickPower;
            let isCritical = false;
            
            // Mostrar mensaje aleatorio
            showRandomHitMessage();
            
            // Chance de golpe crítico
            if (Math.random() < criticalChance) {
                damage = Math.floor(damage * criticalMultiplier);
                isCritical = true;
                showCriticalHit(e);
                
                // Logro de golpe crítico
                if (!achievements[6]) {
                    achievements[6] = true;
                    achievementsUnlocked++;
                    unlockAchievement(6);
                }
            }
            
            // Aplicar daño
            addScore(damage);
            totalHits += damage;
            aitorHealth -= damage;
            
            // Efecto visual
            showDamageEffect(e, damage, isCritical);
            showClickEffect(e);
            animateAitorHit();
            
            // Actualizar barra de salud
            updateAitorHealth();
            
            // Verificar si Aitor ha sido "derrotado" para subir de nivel
            if (aitorHealth <= 0) {
                levelUpAitor();
            }
            
            // Verificar logros por cantidad de golpes
            checkHitAchievements();
            
            // Actualizar UI
            updateUI();
            saveGame();
        }
        
        // Mostrar mensaje aleatorio al golpear
        function showRandomHitMessage() {
            const randomMessage = hitMessages[Math.floor(Math.random() * hitMessages.length)];
            hitMessagesElement.textContent = randomMessage;
            hitMessagesElement.style.opacity = '1';
            
            setTimeout(() => {
                hitMessagesElement.style.opacity = '0';
            }, 1000);
        }
        
        // Ataque especial
        function useSpecialAttack(e) {
            const attackId = e.currentTarget.id;
            const damage = parseInt(e.currentTarget.getAttribute('data-damage'));
            const cooldown = parseInt(e.currentTarget.getAttribute('data-cooldown'));
            
            if (specialAttacksCooldown[attackId] <= 0) {
                // Aplicar daño
                addScore(damage);
                totalHits += damage;
                aitorHealth -= damage;
                
                // Efecto visual
                showDamageEffect({clientX: window.innerWidth/2, clientY: window.innerHeight/2}, damage, true);
                animateAitorHit(true);
                
                // Actualizar barra de salud
                updateAitorHealth();
                
                // Verificar si Aitor ha sido "derrotado" para subir de nivel
                if (aitorHealth <= 0) {
                    levelUpAitor();
                }
                
                // Iniciar cooldown
                specialAttacksCooldown[attackId] = cooldown;
                
                // Actualizar UI
                updateUI();
                saveGame();
            }
        }
        
        // Subir de nivel a Aitor
        function levelUpAitor() {
            aitorLevel++;
            maxAitorHealth = Math.floor(100 * Math.pow(1.3, aitorLevel - 1));
            aitorHealth = maxAitorHealth;
            
            // Actualizar texto del nivel
            let levelText = `Nivel ${aitorLevel} - `;
            if (aitorLevel < 5) levelText += "Aitor Novato";
            else if (aitorLevel < 10) levelText += "Aitor Intermedio";
            else if (aitorLevel < 20) levelText += "Aitor Experto";
            else if (aitorLevel < 30) levelText += "Aitor Máster";
            else levelText += "Aitor Legendario";
            
            aitorLevelElement.textContent = levelText;
            
            // Efecto visual
            showLevelUpEffect();
        }
        
        // Comprar mejora
        function buyUpgrade(e) {
            const upgradeElement = e.currentTarget;
            if (upgradeElement.classList.contains('locked')) return;
            
            const id = upgradeElement.getAttribute('data-id');
            const price = parseInt(upgradeElement.getAttribute('data-price'));
            const multiplier = parseFloat(upgradeElement.getAttribute('data-multiplier'));
            
            if (score >= price) {
                // Comprar mejora
                score -= price;
                upgrades[id] = true;
                upgradesBought++;
                
                // Aplicar efectos de la mejora
                passiveIncome += multiplier;
                
                // Desbloquear siguiente mejora si existe
                const nextUpgrade = document.querySelector(`.upgrade[data-id="${parseInt(id)+1}"]`);
                if (nextUpgrade) {
                    nextUpgrade.classList.remove('locked');
                }
                
                // Marcar como comprada
                upgradeElement.classList.add('unlocked');
                upgradeElement.style.cursor = 'default';
                
                // Logro de primera compra
                if (!achievements[5]) {
                    achievements[5] = true;
                    achievementsUnlocked++;
                    unlockAchievement(5);
                }
                
                // Actualizar UI
                updateUI();
                saveGame();
            }
        }
        
        // Desbloquear logro
        function unlockAchievement(id) {
            const achievementElement = document.querySelector(`.achievement[data-id="${id}"]`);
            if (achievementElement) {
                achievementElement.classList.remove('locked');
                achievementElement.classList.add('unlocked');
                achievementElement.querySelector('.achievement-icon').textContent = '🏆';
                
                // Mostrar notificación
                const achievementName = achievementElement.querySelector('.upgrade-name').textContent;
                showNotification(`¡Logro desbloqueado: ${achievementName}!`);
            }
        }
        
        // Verificar logros por cantidad de golpes
        function checkHitAchievements() {
            if (totalHits >= 10 && !achievements[1]) {
                achievements[1] = true;
                achievementsUnlocked++;
                unlockAchievement(1);
            }
            if (totalHits >= 100 && !achievements[2]) {
                achievements[2] = true;
                achievementsUnlocked++;
                unlockAchievement(2);
            }
            if (totalHits >= 1000 && !achievements[3]) {
                achievements[3] = true;
                achievementsUnlocked++;
                unlockAchievement(3);
            }
            if (totalHits >= 10000 && !achievements[4]) {
                achievements[4] = true;
                achievementsUnlocked++;
                unlockAchievement(4);
            }
        }
        
        // Cambiar de pestaña
        function switchTab(e) {
            const tabId = e.currentTarget.getAttribute('data-tab');
            
            // Actualizar botones de pestaña
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            e.currentTarget.classList.add('active');
            
            // Mostrar pestaña seleccionada
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');
        }
        
        // Añadir puntos
        function addScore(amount) {
            score += amount;
        }
        
        // Actualizar UI
        function updateUI() {
            // Actualizar puntuación
            scoreElement.textContent = `${formatNumber(score)} golpes`;
            scorePerSecondElement.textContent = `${passiveIncome.toFixed(1)} golpes/segundo`;
            
            // Actualizar estadísticas
            document.getElementById('totalHits').textContent = formatNumber(totalHits);
            document.getElementById('clickPower').textContent = clickPower;
            document.getElementById('hitsPerSecond').textContent = passiveIncome.toFixed(1);
            document.getElementById('upgradesBought').textContent = upgradesBought;
            document.getElementById('achievementsUnlocked').textContent = `${achievementsUnlocked}/6`;
            document.getElementById('aitorLevelStat').textContent = aitorLevel;
            
            // Actualizar precios de mejoras
            document.querySelectorAll('.upgrade').forEach(upgrade => {
                const price = parseInt(upgrade.getAttribute('data-price'));
                upgrade.querySelector('.upgrade-price').textContent = formatNumber(price);
                
                // Resaltar mejoras que se pueden comprar
                if (!upgrade.classList.contains('unlocked')) {
                    if (score >= price) {
                        upgrade.style.boxShadow = '0 0 10px var(--color-primary)';
                    } else {
                        upgrade.style.boxShadow = 'none';
                    }
                }
            });
        }
        
        // Actualizar barra de salud de Aitor
        function updateAitorHealth() {
            const percentage = (aitorHealth / maxAitorHealth) * 100;
            aitorHealthBar.style.width = `${percentage}%`;
        }
        
        // Mostrar efecto de daño
        function showDamageEffect(pos, damage, isCritical) {
            const effect = document.createElement('div');
            effect.className = 'damageEffect';
            effect.textContent = `-${damage}`;
            effect.style.left = `${pos.clientX - 20}px`;
            effect.style.top = `${pos.clientY - 20}px`;
            
            if (isCritical) {
                effect.style.color = 'var(--color-primary)';
                effect.style.fontSize = '2rem';
                effect.style.textShadow = '0 0 10px var(--color-secondary)';
            }
            
            document.body.appendChild(effect);
            
            // Eliminar después de la animación
            setTimeout(() => {
                effect.remove();
            }, 1000);
        }
        
        // Mostrar efecto de click
        function showClickEffect(pos) {
            const effect = document.createElement('div');
            effect.id = 'clickEffect';
            effect.style.left = `${pos.clientX}px`;
            effect.style.top = `${pos.clientY}px`;
            document.body.appendChild(effect);
            
            // Eliminar después de la animación
            setTimeout(() => {
                effect.remove();
            }, 500);
        }
        
        // Mostrar golpe crítico
        function showCriticalHit(pos) {
            criticalHitElement.style.left = `${pos.clientX}px`;
            criticalHitElement.style.top = `${pos.clientY}px`;
            criticalHitElement.style.opacity = '1';
            
            // Animación
            setTimeout(() => {
                criticalHitElement.style.opacity = '0';
            }, 1000);
        }
        
        // Mostrar subida de nivel
        function showLevelUpEffect() {
            const effect = document.createElement('div');
            effect.className = 'damageEffect';
            effect.textContent = `¡Nivel ${aitorLevel}!`;
            effect.style.left = '50%';
            effect.style.top = '50%';
            effect.style.transform = 'translate(-50%, -50%)';
            effect.style.color = 'var(--color-primary)';
            effect.style.fontSize = '2rem';
            effect.style.textShadow = '0 0 10px var(--color-secondary)';
            effect.style.zIndex = '100';
            document.body.appendChild(effect);
            
            // Eliminar después de la animación
            setTimeout(() => {
                effect.remove();
            }, 2000);
        }
        
        // Mostrar notificación
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'achievement';
            notification.style.position = 'fixed';
            notification.style.bottom = '20px';
            notification.style.right = '20px';
            notification.style.zIndex = '1000';
            notification.style.animation = 'slideIn 0.5s, slideOut 0.5s 2.5s';
            notification.innerHTML = `
                <div class="achievement-icon">🎉</div>
                <div class="upgrade-info">
                    <p class="upgrade-name">${message}</p>
                </div>
            `;
            document.body.appendChild(notification);
            
            // Eliminar después de la animación
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // Animación de golpe a Aitor
        function animateAitorHit(bigHit = false) {
            if (bigHit) {
                aitorElement.style.transform = 'scale(0.8) rotate(10deg)';
            } else {
                aitorElement.style.transform = 'scale(0.95)';
            }
            
            setTimeout(() => {
                aitorElement.style.transform = 'scale(1) rotate(0deg)';
            }, 200);
        }
        
        // Formatear números
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
        // Guardar juego
        function saveGame() {
            const gameData = {
                score,
                totalHits,
                clickPower,
                passiveIncome,
                upgradesBought,
                achievementsUnlocked,
                aitorLevel,
                aitorHealth,
                maxAitorHealth,
                upgrades,
                achievements
            };
            
            localStorage.setItem('pegaAitorSave', JSON.stringify(gameData));
        }
        
        // Cargar juego
        function loadGame() {
            const savedData = localStorage.getItem('pegaAitorSave');
            if (savedData) {
                const gameData = JSON.parse(savedData);
                
                score = gameData.score || 0;
                totalHits = gameData.totalHits || 0;
                clickPower = gameData.clickPower || 1;
                passiveIncome = gameData.passiveIncome || 0;
                upgradesBought = gameData.upgradesBought || 0;
                achievementsUnlocked = gameData.achievementsUnlocked || 0;
                aitorLevel = gameData.aitorLevel || 1;
                aitorHealth = gameData.aitorHealth || 100;
                maxAitorHealth = gameData.maxAitorHealth || 100;
                
                // Cargar mejoras
                if (gameData.upgrades) {
                    Object.assign(upgrades, gameData.upgrades);
                    
                    // Desbloquear mejoras compradas
                    Object.keys(upgrades).forEach(id => {
                        if (upgrades[id]) {
                            const upgradeElement = document.querySelector(`.upgrade[data-id="${id}"]`);
                            if (upgradeElement) {
                                upgradeElement.classList.add('unlocked');
                                upgradeElement.classList.remove('locked');
                                upgradeElement.style.cursor = 'default';
                                
                                // Desbloquear siguiente mejora
                                const nextUpgrade = document.querySelector(`.upgrade[data-id="${parseInt(id)+1}"]`);
                                if (nextUpgrade) {
                                    nextUpgrade.classList.remove('locked');
                                }
                            }
                        }
                    });
                }
                
                // Cargar logros
                if (gameData.achievements) {
                    Object.assign(achievements, gameData.achievements);
                    
                    // Desbloquear logros conseguidos
                    Object.keys(achievements).forEach(id => {
                        if (achievements[id]) {
                            unlockAchievement(id);
                        }
                    });
                }
                
                // Actualizar nivel de Aitor
                let levelText = `Nivel ${aitorLevel} - `;
                if (aitorLevel < 5) levelText += "Aitor Novato";
                else if (aitorLevel < 10) levelText += "Aitor Intermedio";
                else if (aitorLevel < 20) levelText += "Aitor Experto";
                else if (aitorLevel < 30) levelText += "Aitor Máster";
                else levelText += "Aitor Legendario";
                
                aitorLevelElement.textContent = levelText;
                updateAitorHealth();
            }
        }
        
        // Iniciar el juego cuando se cargue la página
        window.addEventListener('load', initGame);
    </script>

<script>
  // Registra el service worker
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('sw.js')
        .then(registration => {
          console.log('ServiceWorker registrado con éxito:', registration.scope);
        })
        .catch(error => {
          console.log('Error al registrar el ServiceWorker:', error);
        });
    });
  }
</script>

</body>
</html>
